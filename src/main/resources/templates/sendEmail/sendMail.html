<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Send Email</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        /* Smooth fade-out animation */
        .fade-out {
            opacity: 0;
            transition: opacity 1s ease-out;
        }

        @keyframes popIn {
            0% { transform: scale(0.9); opacity: 0; }
            80% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); }
        }

        .alert {
            animation: popIn 0.3s ease-out;
        }

        /* Hide optional sections */
        .hidden {
            display: none;
        }
    </style>
</head>
<body class="bg-light">

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6">

            <!-- ðŸ”” Alert Message -->
            <div th:if="${message}"
                 th:classappend="' alert ' + ${alertClass}"
                 class="alert text-center"
                 role="alert"
                 id="alertBox">
                <span th:text="${message}"></span>
            </div>

            <!-- ðŸ“§ Email Form Card -->
            <div class="card shadow border-0 rounded-4">
                <div class="card-body p-4">
                    <h3 class="text-center mb-4 text-primary">Send Email</h3>

                    <!-- ðŸŸ¡ Dropdown to select send mode -->
                    <div class="mb-3">
                        <label class="form-label fw-bold">Select Sending Option</label>
                        <select id="sendOption" class="form-select">
                            <option value="single" selected>Send to a Specific Email</option>
                            <option value="few">Send to Selected Emails (from DB)</option>
                            <option value="all">Send to All Saved Emails</option>
                        </select>
                    </div>

                    <!-- âœ… Single email form -->
                    <form id="singleForm" th:action="@{/sendEmail/send-email}" method="post" th:object="${singleUsersDto}">
                        <div class="mb-3">
                            <label for="email" class="form-label">Recipient Email</label>
                            <input type="email" id="email" th:field="*{email}" class="form-control" placeholder="Enter recipient email" required>
                        </div>

                        <div class="mb-3">
                            <label for="subject" class="form-label">Subject</label>
                            <input type="text" id="subject" th:field="*{subject}" class="form-control" placeholder="Enter subject" required>
                        </div>

                        <div class="mb-3">
                            <label for="description" class="form-label">Message</label>
                            <textarea id="description" th:field="*{description}" class="form-control" rows="5" placeholder="Write your message..." required></textarea>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg">Send Email</button>
                        </div>
                    </form>
                    <form id="fewForm" class="hidden">
                        <div class="text-center text-muted">Coming soon...</div>
                    </form>


                    <!--  All users form -->
                    <form id="allForm" class="hidden" th:action="@{/sendEmail/send-to-all}" method="post" th:object="${allUsersDto}">
                        <div class="mb-3">
                            <label for="subjectAll" class="form-label">Subject</label>
                            <input type="text" id="subjectAll" th:field="*{subject}" class="form-control" required>
                        </div>

                        <div class="mb-3">
                            <label for="descriptionAll" class="form-label">Message</label>
                            <textarea id="descriptionAll" th:field="*{description}" class="form-control" rows="5" required></textarea>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-warning btn-lg">Send to All</button>
                        </div>
                    </form>

                </div>
            </div>

            <p class="text-center mt-3 text-muted">&copy; 2025 Email Sender</p>
        </div>
    </div>
</div>

<!--  Auto-hide alert after 5 seconds -->
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const alertBox = document.getElementById("alertBox");
        if (alertBox) {
            setTimeout(() => {
                alertBox.classList.add("fade-out");
                setTimeout(() => alertBox.remove(), 1000);
            }, 5000);
        }

        const sendOption = document.getElementById("sendOption");
        const singleForm = document.getElementById("singleForm");
        const fewForm = document.getElementById("fewForm");
        const allForm = document.getElementById("allForm");

        sendOption.addEventListener("change", function() {
            singleForm.classList.add("hidden");
            fewForm.classList.add("hidden");
            allForm.classList.add("hidden");

            if (this.value === "single") singleForm.classList.remove("hidden");
            else if (this.value === "few") fewForm.classList.remove("hidden");
            else allForm.classList.remove("hidden");
        });
    });
</script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
